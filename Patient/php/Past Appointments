<?php
// Database credentials
$host = 'localhost'; // Replace with your host name
$dbname = 'healthconsultancy'; // Replace with your database name
$username = 'root'; // Replace with your database username
$password = ''; // Replace with your database password

// Establish a PDO database connection
try {
    $pdo = new PDO("mysql:host=$host;dbname=$dbname", $username, $password);
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    die ("Connection failed: " . $e->getMessage());
}

// Function to filter appointments based on search criteria
function filterAppointments($criteria, $appointments)
{
    $filteredAppointments = $appointments;

    // Implement your filtering logic here

    return $filteredAppointments;
}

// Fetch data from the database using PDO
$stmt = $pdo->query("SELECT * FROM appointmentdetails"); // Replace 'your_table_name' with your actual table name
$appointments = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Check if search criteria are provided
if (isset ($_POST['date']) || isset ($_POST['DoctorName']) || isset ($_POST['AppointmentID'])) {
    $filteredAppointments = filterAppointments($_POST, $appointments);
    // Display appointment details
    if (!empty ($filteredAppointments)) {
        echo '<ul>';
        foreach ($filteredAppointments as $appointment) {
            echo '<li>';
            echo '<strong>Doctor Name:</strong> ' . $appointment['DoctorName'] . '<br>';
            echo '<strong>Doctor ID:</strong> ' . $appointment['UID'] . '<br>';
            echo '<strong>Doctor Type:</strong> ' . $appointment['DoctorType'] . '<br>';
            echo '<strong>Patient Name:</strong> ' . $appointment['PatientsName'] . '<br>';
            echo '<strong>Patient Email:</strong> ' . $appointment['PatientEmail'] . '<br>';
            echo '<strong>Patient Age:</strong> ' . $appointment['PatientAge'] . '<br>';
            echo '<strong>Diagnosis:</strong> ' . $appointment['Diagnosis'] . '<br>';
            echo '<strong>Appointment Number:</strong> ' . $appointment['AppointmentID'] . '<br>';
            echo '<strong>Symptoms:</strong> ' . $appointment['Symptom'] . '<br>';
            echo '</li>';
        }

        echo '</ul>';
    } else {
        echo 'No appointments found.';
    }
} else {
    // Display search form for appointments
    echo '<form action="" method="post">';
    echo 'Date: <input type="date" name="date"><br>';
    echo 'Doctor Name: <input type="text" name="DoctorName"><br>';
    echo 'Appointment Number: <input type="number" name="AppointmentID"><br>';
    echo '<input type="submit" value="Search">';
    echo '</form>';
}
?>
